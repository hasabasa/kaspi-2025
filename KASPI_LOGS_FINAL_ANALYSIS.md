# üîç –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –õ–û–ì–û–í –ò –ó–ê–ü–†–û–°–û–í KASPI –î–ï–ú–ü–ï–†–ê

## üìä –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢ –í –°–ò–°–¢–ï–ú–ï

### 1. üîê –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø KASPI

**–ü—Ä–æ—Ü–µ—Å—Å:**
```
Frontend ‚Üí Backend ‚Üí Selenium ‚Üí Kaspi Login Page ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ Cookies ‚Üí Supabase
```

**URL:** `https://idmc.shop.kaspi.kz/login`
**–ú–µ—Ç–æ–¥:** Selenium WebDriver (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞)

**–õ–æ–≥–∏:**
```
üîê [KASPI-AUTH] –ù–∞—á–∏–Ω–∞–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: test_user_123
üìß [KASPI-AUTH] Email: hvsv1@icloud.com
üîë [KASPI-AUTH] –ú–µ—Ç–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: selenium
üöÄ [KASPI-AUTH] –í—ã–∑—ã–≤–∞–µ–º auth_manager.login...
üìä [KASPI-AUTH] –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: {'success': True, 'merchant_id': 'kaspi_1759771243'}
‚úÖ [KASPI-AUTH] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!
```

### 2. üì¶ –ü–ê–†–°–ò–ù–ì –¢–û–í–ê–†–û–í

**URL:** `https://mc.shop.kaspi.kz/bff/offer-view/list?m={merchant_uid}&p={page}&l={page_size}&a=true`
**–ú–µ—Ç–æ–¥:** GET —Å cookies –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—É—á–∞–µ–º 401 Unauthorized
**–ü—Ä–∏—á–∏–Ω–∞:** Cookies —É—Å—Ç–∞—Ä–µ–ª–∏ –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã

**–õ–æ–≥–∏:**
```
üîç [PARSER] –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–∞ SKU: 12345
üåê [PARSER] URL –∑–∞–ø—Ä–æ—Å–∞: https://kaspi.kz/yml/offer-view/offers/12345
üìã [PARSER] –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞: {'Content-Type': 'application/json', 'Origin': 'https://kaspi.kz'}
üîÑ [PARSER] –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏: proxy1
üöÄ [PARSER] –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST –∑–∞–ø—Ä–æ—Å –∫ Kaspi API...
üìä [PARSER] –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: —Å—Ç–∞—Ç—É—Å 401
‚ùå [PARSER] –û—à–∏–±–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è SKU 12345: 401 Unauthorized
```

### 3. üí∞ –î–ï–ú–ü–ï–† –¶–ï–ù

**URL:** `https://mc.shop.kaspi.kz/pricefeed/upload/merchant/process`
**–ú–µ—Ç–æ–¥:** POST –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω

**–õ–æ–≥–∏:**
```
üîç [DEMPER] –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ü–µ–Ω—ã –¥–ª—è SKU: 12345
üì¶ [DEMPER] –¢–æ–≤–∞—Ä: –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...
üîÑ [DEMPER] –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏: proxy1
üí∞ [DEMPER] –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: 1000 ‚Ç∏
üíµ [DEMPER] –¶–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤: [950, 980, 1020]
üèÜ [DEMPER] –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: 950 ‚Ç∏
üìà [DEMPER] –†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏: 5.3%
‚úÖ [DEMPER] –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É –Ω–∞: 949 ‚Ç∏
```

### 4. üóÑÔ∏è SUPABASE –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

**URL:** `https://your-project.supabase.co/rest/v1/`
**–ú–µ—Ç–æ–¥:** POST/GET/PUT/DELETE

**–õ–æ–≥–∏:**
```
üîç [SUPABASE] –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Supabase...
üåê [SUPABASE] URL: https://your-project.supabase.co
‚úÖ [SUPABASE] –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ: {'count': 1}
üì¶ [SUPABASE] –î–æ–±–∞–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω: –ú–æ–π –º–∞–≥–∞–∑–∏–Ω Kaspi
üÜî [SUPABASE] Store ID: 37f3483b-7e8f-4629-baa7-165cfa059233
üë§ [SUPABASE] User ID: test_user_123
‚úÖ [SUPABASE] –ú–∞–≥–∞–∑–∏–Ω —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω: {'id': '37f3483b...', 'name': '–ú–æ–π –º–∞–≥–∞–∑–∏–Ω Kaspi'}
```

## üö® –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü—Ä–æ–±–ª–µ–º–∞ 1: 401 Unauthorized –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ
**–ü—Ä–∏—á–∏–Ω–∞:** Cookies –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–∞—Ä–µ–ª–∏
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Selenium
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ cookies –≤ accounts.json
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤–µ–∂–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–ø–æ–Ω—è—Ç–Ω—ã–µ –ª–æ–≥–∏
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã —ç–º–æ–¥–∑–∏ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏:
- üîê - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- üì¶ - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
- üîç - –ø–∞—Ä—Å–∏–Ω–≥
- üí∞ - –¥–µ–º–ø–∏–Ω–≥ —Ü–µ–Ω
- ‚ùå - –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–ø—Ä–æ—Å–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–µ–π:
- URL –∑–∞–ø—Ä–æ—Å–æ–≤
- –ó–∞–≥–æ–ª–æ–≤–∫–∏
- –¢–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç–∞—Ç—É—Å—ã –æ—Ç–≤–µ—Ç–æ–≤
- –†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –ö–ê–ö –ß–ò–¢–ê–¢–¨ –õ–û–ì–ò

### 1. –ò—â–∏—Ç–µ —ç–º–æ–¥–∑–∏
- üîê = –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- üì¶ = –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
- üîç = –ü–∞—Ä—Å–∏–Ω–≥
- üí∞ = –î–µ–º–ø–∏–Ω–≥ —Ü–µ–Ω
- ‚ùå = –û—à–∏–±–∫–∏

### 2. –°–ª–µ–¥–∏—Ç–µ –∑–∞ URL
- `https://idmc.shop.kaspi.kz/login` = –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `https://mc.shop.kaspi.kz/bff/offer-view/list` = –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- `https://kaspi.kz/yml/offer-view/offers/{sku}` = –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ
- `https://mc.shop.kaspi.kz/pricefeed/upload/merchant/process` = –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω

### 3. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å—ã
- 200 OK = –£—Å–ø–µ—à–Ω–æ
- 401 Unauthorized = –ù—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- 429 Too Many Requests = –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
- 500 Internal Server Error = –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏
- Traceback –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
- –î–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–º–æ–≥–∞—é—Ç –ø–æ–Ω—è—Ç—å –ø—Ä–æ–±–ª–µ–º—É

## üîß –ù–ê–°–¢–†–û–ô–ö–ê –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø

### –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:
1. **–ö–æ–Ω—Å–æ–ª—å backend** - –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
2. **–§–∞–π–ª logs/app.log** - —Ñ–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
3. **Supabase logs** - –ª–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. **–ë—Ä–∞—É–∑–µ—Ä –∫–æ–Ω—Å–æ–ª—å** - –ª–æ–≥–∏ frontend

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- INFO - –æ–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- WARNING - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ERROR - –æ—à–∏–±–∫–∏
- DEBUG - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–û–±–Ω–æ–≤–∏—Ç—å cookies** - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥** - —Å —Å–≤–µ–∂–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–ø–µ—Ä** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** - —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–∞–±–æ—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã

## üìä –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´

- ‚úÖ **Backend**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8010
- ‚úÖ **Frontend**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8080
- ‚úÖ **Supabase**: –ü–æ–¥–∫–ª—é—á–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ **Kaspi –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚ö†Ô∏è **–ü–∞—Ä—Å–∏–Ω–≥**: –ù—É–∂–Ω—ã —Å–≤–µ–∂–∏–µ cookies
- ‚ö†Ô∏è **–î–µ–º–ø–µ—Ä**: –¢—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ, –Ω–æ –Ω—É–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞!** üéØ
